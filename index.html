<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Last 5 Posts</title>
</head>
<body>
    <h1>Instagram User Info</h1>
    <button id="fetchDataBtn">Fetch Data</button>

    <h2>Profile Info</h2>
    <p><strong>Username:</strong> <span id="igUsername"></span></p>
    <p><strong>Followers:</strong> <span id="igFollowers"></span></p>

    <h2>Last 5 Posts</h2>
    <ul id="postsList"></ul> <!-- This will display the last 5 posts -->

    <script>
        document.getElementById('fetchDataBtn').addEventListener('click', function() {
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "application/json");

            var requestOptions = {
                method: "GET",
                headers: myHeaders,
                redirect: "follow",
            };

            fetch("https://v1.nocodeapi.com/azzam/instagram/WzsSUiQzkbXtcXIT", requestOptions)
                .then(response => response.json())  // Parse the response as JSON
                .then(data => {
                    console.log(data); // Check the full API response in the console

                    // Update Profile Info
                    document.getElementById('igUsername').textContent = data.username || 'N/A';
                    document.getElementById('igFollowers').textContent = data.followers || 'N/A';

                    // Update Last 5 Posts
                    const postsList = document.getElementById('postsList');
                    postsList.innerHTML = '';  // Clear any existing content
                    if (data.recent_posts && data.recent_posts.length > 0) {
                        data.recent_posts.slice(0, 5).forEach(post => {
                            const li = document.createElement('li');
                            li.innerHTML = `
                                <p><strong>Caption:</strong> ${post.caption || 'No Caption'}</p>
                                <p><strong>Likes:</strong> ${post.likes || 0}</p>
                                <p><strong>Comments:</strong> ${post.comments || 0}</p>
                                <img src="${post.image_url}" alt="Post Image" width="200">
                            `;
                            postsList.appendChild(li);
                        });
                    } else {
                        postsList.innerHTML = '<li>No recent posts available.</li>';
                    }
                })
                .catch(error => {
                    console.log('Error fetching data:', error); // More detailed error logging
                    alert('Error fetching data. Check the console for details.');
                });
        });
    </script>
</body>
</html>
